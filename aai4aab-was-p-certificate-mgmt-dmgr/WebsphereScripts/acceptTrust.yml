---
- name: save the trust store for wsadmin
  copy:
   src: "{{ keyFilePath }}/{{ trustFileName }}"
   dest: "{{ keyFilePath }}/{{ trustStoreBCK }}"
   remote_src: yes
   mode: preserve
  vars:
   keyFilePath: "/appl/was/profiles/dmgr/etc"
   trustFileName: "trust.p12"
   trustStoreBCK: "{{ trustFileName }}.{{ backupPostfix }}"
  when: first_entry is not defined or first_entry != True

- name: accept Trust
  block:
    - name: update dmgr etc trust
      aai4aab.websphere.retrievesigners:
        profile_name: dmgr
        remote_keystore_name: CellDefaultTrustStore 
        local_keystore_name: ClientDefaultTrustStore
        auto_accept_bootstrap_signer: true
      register: rc
  rescue:
    - name: show error message
      debug:
        var: rc
      failed_when: rc.rc != 0
- name: accept Trust
  block:
    - name: update node etc trust
      aai4aab.websphere.retrievesigners:
        profile_name: node
        remote_keystore_name: CellDefaultTrustStore 
        local_keystore_name: ClientDefaultTrustStore
        auto_accept_bootstrap_signer: true
      register: rc
  rescue:
    - name: show error message
      debug:
        var: rc
      failed_when: rc.rc != 0
